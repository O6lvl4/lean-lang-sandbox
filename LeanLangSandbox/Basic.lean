-- ============================================
-- Lean 4 定理証明入門
-- 「コンパイルが通る = 証明完了」の世界
-- ============================================

-- ----------------------------------------
-- 1. 最もシンプルな証明: P ならば P
-- ----------------------------------------
-- 「PがtrueならPはtrue」… 当たり前だけど、これが証明の第一歩
theorem identity (P : Prop) : P → P :=
  fun h => h  -- hはPの証拠。そのまま返せばOK

-- ----------------------------------------
-- 2. P ∧ Q → Q ∧ P （AND の交換法則）
-- ----------------------------------------
-- 「PかつQ」なら「QかつP」。人間には自明だが、証明が要る
theorem and_comm_proof (P Q : Prop) : P ∧ Q → Q ∧ P :=
  fun ⟨hp, hq⟩ => ⟨hq, hp⟩  -- 分解して入れ替えるだけ

-- ----------------------------------------
-- 3. タクティクモードで同じことを証明
-- ----------------------------------------
-- `by` の中で対話的にゴールを潰していくスタイル
theorem and_comm_tactic (P Q : Prop) : P ∧ Q → Q ∧ P := by
  intro ⟨hp, hq⟩   -- 仮定を導入して分解
  exact ⟨hq, hp⟩   -- ゴールにぴったりの証拠を渡す

-- ----------------------------------------
-- 4. 自然数の性質: 0 + n = n
-- ----------------------------------------
-- Lean の Nat.add は左側で再帰するので、0 + n = n は定義から自明 (rfl)
theorem zero_add (n : Nat) : 0 + n = n := by
  induction n with       -- n について帰納法
  | zero => rfl          -- 0 + 0 = 0 は定義そのまま
  | succ k ih =>         -- 0 + (k+1) = k+1 を示す
    simp                 -- simplifier が解決

-- ----------------------------------------
-- 5. n + 0 = n （逆向きは自明じゃない！）
-- ----------------------------------------
-- 右側の 0 は再帰で消えないので、帰納法が必要
theorem add_zero (n : Nat) : n + 0 = n := by
  induction n with
  | zero => rfl
  | succ k ih =>
    simp

-- ----------------------------------------
-- 6. 論理パズル: 対偶の証明
-- ----------------------------------------
-- 「P→Q」ならば「¬Q→¬P」
theorem contrapositive (P Q : Prop) : (P → Q) → (¬Q → ¬P) :=
  fun hpq hnq hp => hnq (hpq hp)
  -- hpq : P → Q, hnq : ¬Q, hp : P のとき
  -- hpq hp で Q を得て、hnq に渡すと矛盾 (False)

-- ----------------------------------------
-- おまけ: 証明を使って安全なプログラムを書く
-- ----------------------------------------
-- 「空でないリストの先頭要素」を型で保証
def safeHead (xs : List α) (h : xs ≠ []) : α :=
  match xs, h with
  | x :: _, _ => x

-- Main で使うための hello
def hello := "world"
